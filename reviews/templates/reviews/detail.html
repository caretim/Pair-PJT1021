{% extends 'base.html' %}
{% load django_bootstrap5%}
{% load static %}
{% block content %}
<div class="detail-container">
<!-- 글 헤더(프로필, 글 제목) -->
  <div class="article-title p-3">
    <!-- 글 제목 -->
    <div class="d-flex align-items-center">
      <div class="detail-header">{{ header }}</div>
      <h1 class="detail-title text-start fw-bold">{{ review.title }}</h1>
    </div>
    <!-- 프로필 -->
    <div class="d-flex align-items-center">
      <!-- 프로필 사진 -->
      {% if review.user.image %}
        <img src="{{ review.user.image.url }}" alt="프로필 이미지" class="detail-img">
      {% else %}
        <img src="{% static 'images/goose.png' %}" alt="프로필 대체 이미지" class="detail-img">
      {% endif %}
      <h2 class="detail-user-name">{{ review.user }}</h2>
  </div>

  <hr>

  <div>
    {% for member in members %}
    {{member}}
    {% endfor %}
  </div>
  <a href="{% url 'accounts:user_detail' review.pk  %}">{{ review.user }}
  </a>
  # 글쓴이

  <!-- 글 내용 -->
  <div class="review-content p-3">
    {{ review.content }}
  </div>
  #{{ game }}
  #{{ review.member }}명
  #{{ header }}

  <!-- 여기 새로 만드는 중 공사중 -->
  <div class="detail-box">
    <div class="detail-box-tag">
      #{{ game }}
      #{{ review.member }}명
      #{{ header }}
    </div>
    <div class="row">
      <div class="col-8">
        <div class="detail-box-content">
          {{ review.content }}
        </div>
      </div>
      <div class="col-4">
        <div class="detail-box-join text-center">
          <div>
            <h2>현재 참가자 명단</h2>
            <h2>{{ members.count }} / {{ review.member }}</h2>
          </div>
          {% for member in members %}
            <div>
              {% if review.user.image %}
                <img src="{{ review.user.image.url }}" alt="프로필 이미지" class="detail-img">
              {% else %}
                <img src="{% static 'images/goose.png' %}" alt="프로필 대체 이미지" class="detail-img">
              {% endif %}
              <h2 class="detail-user-name">{{ review.user }}</h2>
              <img src="" alt="참가자 프로필 사진">
              <h4>{{ member }}</h4>
              
            </div>
          {% endfor %}
        </div>
      </div>
    </div>
  </div>
  <!-- 여기까지 공사중 -->

  <!-- 참여하기 버튼 -->
  <a href="{% url 'reviews:join_member' review.pk %}" class="pt-btn d-flex justify-content-center">
    {% if request.user in members %}
    <div class="pt-n rounded">
    참여취소
  </div>
      {% else %}
      <div class="pt-y rounded">
        지금 참여하기!
      </div>
      {% endif %}
    </a>
  
  {% comment %} 댓글 {% endcomment %}
  <hr>
  <h1>댓글</h1>
  <p>{{review.comment_set.all|length }}개의 댓글이 있습니다.</p>
  <form action="{% url 'reviews:comments' review.pk  %}" method="POST">
    {% csrf_token %}
    {% bootstrap_form comment_form %}
    <input type="submit" class="btn btn-outline-primary">
  </form>
  <hr>
  {% for comment in review.comment_set.all %}
    <p>{{comment.content}}
      |
      <a href="{% url 'accounts:user_detail' comment.pk  %}">{{comment.user}}
      </a>
    </p>
    {%if comment.user == reuqest.user %}
      <form action="{% url 'reviews:comments_delete' review.pk comment.pk %}" method="POST">
        {% csrf_token %}
        <input type="submit" value="삭제">
      </form>
      <form action="{% url 'reviews:comments_update' review.pk comment.pk %}" method="POST">
        {% csrf_token %}
        <input type="submit" value="수정">
      </form>
    {% endif %}
  {% endfor %}
</div>
  <script></script>

  <style>

  </style>
{% endblock %}